// ====================================================
//      Routes API: Vulnerability Type
// ====================================================

const express = require('express');
const vulnerabilityTypeController = require('../controllers/vulnerabilityType');
const { authenticate, verifiedAdminRol } = require('../middlewares/auth.js');
const api = express.Router();

// =================================
// Todos los tipos de vulnerabilidad
// =================================
api.get('/all', [authenticate, verifiedAdminRol], vulnerabilityTypeController.getVulnerabilityTypes);

// ===============================================
// Todos los tipos de vulnerabilidads por estatus
// ===============================================
api.get('/all/:status', authenticate, vulnerabilityTypeController.getVulnerabilityTypesByStatus);

// ===================================
// Un tipo de vulnerabilidad por id
// ===================================
api.get('/:id', [authenticate, verifiedAdminRol], vulnerabilityTypeController.getVulnerabilityTypeById);

// ====================================
// Crear nuevo tipo de vulnerabilidad
// ====================================
api.post('/save', [authenticate, verifiedAdminRol], vulnerabilityTypeController.saveVulnerabilityType);

// ====================================
// Actualizar tipo de vulnerabilidad
// ====================================
api.put('/:id', [authenticate, verifiedAdminRol], vulnerabilityTypeController.updateVulnerabilityType);

// ==============================================
// Actualizar status de tipo de vulnerabilidad
// ==============================================
api.put('/:id/status', [authenticate, verifiedAdminRol], vulnerabilityTypeController.updateVulnerabilityTypeStatus);

// ====================================
// Eliminar tipo de vulnerabilidad
// ====================================
api.delete('/:id', [authenticate, verifiedAdminRol], vulnerabilityTypeController.deleteVulnerabilityType);

module.exports = api;